<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
        <title class="customer-name">Made in Marikina - Products</title>

        <!-- icons -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css">

         <!-- bootstrap and css -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/CustomerProfile.css">

        <!--javascript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script type="text/javascript">
            var userID = localStorage.getItem("userID");
            var uid;
            
            //popups
            function ViewOrderPending() {
                document.getElementById("view_order").style.display = "block";
                document.getElementById("bgoverlay").style.display = "block";
                document.getElementById("view_order").style.display = "block";
            }
            function ViewOrderCustom() {
                document.getElementById("edit_order").style.display = "none";
                document.getElementById("view_order").style.display = "block";
                document.getElementById("bgoverlay").style.display = "block";
                document.getElementById("view_order").style.display = "block";
            }
            function ViewOrderRTW() {
                document.getElementById("edit_order").style.display = "none";
                document.getElementById("completedrating").style.display = "none";
                document.getElementById("view_orderRTW").style.display = "block";
                document.getElementById("bgoverlay").style.display = "block";
                document.getElementById("view_order").style.display = "block";
            }
            function ViewOrderRTWCompleted() {
                document.getElementById("edit_order").style.display = "none";
                document.getElementById("view_orderRTW").style.display = "block";
                document.getElementById("bgoverlay").style.display = "block";
                document.getElementById("view_order").style.display = "block";
                document.getElementById("completedrating").style.display = "block";
            }

            function ClosePopup() {
                document.getElementById("bgoverlay").style.display = "none";
                document.getElementById("view_order").style.display = "none";
                document.getElementById("view_orderRTW").style.display = "none";
            }


            var ordersReference = firebase.database().ref().child("users/" + userID + "/orders/");

            ordersReference.on("child_added", snap => {
            var oID = snap.child("orderID").val();
            var prodId = snap.child("prodId").val();
            var prodName = snap.child("prodName").val();
            var prodPrice = snap.child("prodPrice").val();
            var prodColor = snap.child("prodColor").val();
            var prodSize = snap.child("prodSize").val();
            var orderQty = snap.child("prodQty").val();
            var imageLink = snap.child("imageLink").val();
            var cshmkrName = snap.child("shoemakerName").val();
            var orderStatus = snap.child("status").val();
            var orderType = snap.child("orderType").val();
            var uid = snap.child("userID").val();
            
            $(".orderstatus").append('<tr class="order-rows"><td><img class="product-image" src=" ' + imageLink + ' "></td><td><table class="specs"><tr class="spec-row"><td class="spec-title"><h6> ' + prodName + '</h6></td></tr><tr class="spec-row"><td class="spec-value"> ' + cshmkrName + ' </td></tr></table></td><td>₱' + prodPrice + '.00</td><td> RTW </td><td id="pendingaccepted"> ' + orderStatus + ' </td><td><button class="button-actions" onclick="ViewOrderRTW(' + uid + ')"><i class="bi bi-eye"></i><span>VIEW</span></button></td></tr> ');
            });

            
            function ViewOrderRTW(id) {
                uid = id;
                
                firebase.database()
                    .ref("users/" + uid)
                    .on("value", function (snap) {
                        var fName = snap.val().firstName;
                        var lName = snap.val().lastName;
                        var cNum = snap.val().contactNo;

                        var fullName = fName + ' ' + lName;

                        firebase.database()
                        .ref("users/" + uid + "/address/" + 1)
                        .on("value", function (snap) {
                            
                            var hNo = snap.val().houseNo;
                            var stName = snap.val().streetName;
                            var brgy = snap.val().barangay;
                            var city = snap.val().city;
                            var pCode = snap.val().postalCode;

                            var address = hNo + ' ' + stName + ', ' + brgy + ', ' + city + ', ' + pCode;

                            document.getElementById("rAddress").innerHTML = address;
                            });

                        document.getElementById("rFullName").value = fullName;
                        document.getElementById("rContactNo").value = cNum;
                    })
            }


            var customOrdersReference = firebase.database().ref().child("users/" + userID + "/customOrders/");

            customOrdersReference.on("child_added", snap => {
            var oID = snap.child("orderID").val();
            var prodId = snap.child("prodId").val();
            var prodName = snap.child("prodName").val();
            var prodPrice = snap.child("prodPrice").val();
            var prodColor = snap.child("prodColor").val();
            var prodSize = snap.child("prodSize").val();
            var orderQty = snap.child("prodQty").val();
            var imageLink = snap.child("imageLink").val();
            var cshmkrName = snap.child("shoemakerName").val();
            var orderStatus = snap.child("status").val();
            var orderType = snap.child("orderType").val();
            
            $(".orderstatus").append('<tr class="order-rows"><td><img class="product-image" src=" ' + imageLink + ' "></td><td><table class="specs"><tr class="spec-row"><td class="spec-title"><h6> ' + prodName + '</h6></td></tr><tr class="spec-row"><td class="spec-value"> ' + cshmkrName + ' </td></tr></table></td><td>₱' + prodPrice + '.00</td><td> Custom Order </td><td id="pendingaccepted"> ' + orderStatus + ' </td><td><button class="button-actions" onclick="ViewOrderCustom()"><i class="bi bi-eye"></i><span>VIEW</span></button></td></tr> ');
            });

        </script>
    </head>
    <body>
        <div class="bgoverlay" id="bgoverlay">
        </div>
        <div class="top-level">
            <div class="top-title">
                <h1>Order History</h1>
            </div>
        </div>

        <div class="table-status">
            <table class="orderstatus">
                <tr>
                    <th><h4 class="tblHeader">IMAGE</h4></th>
                    <th><h4 class="tblHeader">SHOE NAME/TYPE</h4></th>
                    <th><h4 class="tblHeader">PRICE</h4></th>
                    <th><h4 class="tblHeader">ORDER TYPE</h4></th>
                    <th><h4 class="tblHeader">STATUS</h4></th>
                    <th><h4 class="tblHeader">ACTIONS</h4></th>
                </tr>
                
            </table>
        </div>

            <!--VIEW ORDER CUSTOM-->
        <div class="popup" id="view_order">
            <div class="popup-scrollable">
                <i class="bi bi-x" onclick="ClosePopup()"></i>
                <div class="custom-content">
                    <div class="table-view order-details">
                        <table>
                            <tr>
                                <th><h4 class="tblHeader">CUSTOMER NAME</h4></th>
                                <td><p>Juan Dela Cruz</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">CONTACT NUMBER</h4></th>
                                <td><p>+639876543210</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">ADDRESS</h4></th>
                                <td><p>123 Sample St. San Roque, Marikina City, 1801</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">ORDER STATUS</h4></th>
                                <td><p>Completed</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">DATE ORDERED</h4></th>
                                <td><p>February 14, 2022</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">DATE COMPLETED</h4></th>
                                <td><p>February 20, 2022</p></td>
                            </tr> 
                            <tr>
                                <th><h4 class="tblHeader">ORDER TYPE</h4></th>
                                <td><p>Custom</p></td>
                            </tr> 
                            <tr>
                                <th><h4 class="tblHeader">PRICE</h4></th>
                                <td><p>₱245.00</p></td>
                            </tr> 
                            </table>
                    </div>
                    <div class="vieworder-img">
                        <img src="" alt="custom order image">
                    </div>
                    <div class="table-view">
                        <table>
                            <tr>
                                <th><h4 class="tblHeader">SHOE TYPE</h4></th>
                                <td><p>Topsider</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">SHOE MAKER</h4></th>
                                <td><p>Tatay Oly Shoes</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">SIZE</h4></th>
                                <td><p>7</p></td>
                            </tr> 
                            <tr>
                                <th><h4 class="tblHeader">QUANTITY</h4></th>
                                <td><p>350</p></td>
                            </tr> 
                            <tr>
                                <th><h4 class="tblHeader">MATERIAL</h4></th>
                                <td><p>Leather</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">UPPER LEATHER</h4></th>
                                <td><p>WHITE</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">SHOELACE</h4></th>
                                <td><p>WHITE</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">EYELET</h4></th>
                                <td><p>WHITE</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">OUT SOLE</h4></th>
                                <td><p>WHITE</p></td>
                            </tr>
                            <tr>
                                <th><h4 class="tblHeader">THREAD</h4></th>
                                <td><p>WHITE</p></td>
                            </tr>
                        </table>
                    </div>
                </div>
        </div>

        </div>
            <!--VIEW ORDER RTW-->
            <div class="popup" id="view_orderRTW">
                <div class="popup-scrollable">
                    <i class="bi bi-x" onclick="ClosePopup()"></i>
                    <div class="custom-content">
                        <div class="table-view order-details">
                            <table>
                                <tr>
                                    <th><h4 class="tblHeader">CUSTOMER NAME</h4></th>
                                    <td><p id="rFullName"></p></td>
                                </tr>
                                <tr>
                                    <th><h4 class="tblHeader">CONTACT NUMBER</h4></th>
                                    <td><p id="rContactNo"></p></td>
                                </tr>
                                <tr>
                                    <th><h4 class="tblHeader">ADDRESS</h4></th>
                                    <td><p id="rAddress"></p></td>
                                </tr>
                                <tr>
                                    <th><h4 class="tblHeader">ORDER STATUS</h4></th>
                                    <td><p>Accepted</p></td>
                                </tr>
                                <tr>
                                    <th><h4 class="tblHeader">DATE ORDERED</h4></th>
                                    <td><p>February 14, 2022</p></td>
                                </tr>
                                <tr>
                                    <th><h4 class="tblHeader">DATE COMPLETED</h4></th>
                                    <td><p>N/A</p></td>
                                </tr> 
                                <tr>
                                    <th><h4 class="tblHeader">ORDER TYPE</h4></th>
                                    <td><p>RTW</p></td>
                                </tr> 
                                <tr>
                                    <th><h4 class="tblHeader">PRICE</h4></th>
                                    <td><p>₱245.00</p></td>
                                </tr> 
                            </table>
                        </div>
                        <div class="vieworder-img">
                            <img src="" alt="custom order image">
                        </div>
                        <div class="table-view">
                            <table>
                                <tr>
                                    <th><h4 class="tblHeader">SHOE NAME</h4></th>
                                    <td><p>Birkenstock (Madrid)</p></td>
                                </tr>
                                <tr>
                                    <th><h4 class="tblHeader">SHOE MAKER</h4></th>
                                    <td><p>Inches Footwear</p></td>
                                </tr>
                                <tr>
                                    <th><h4 class="tblHeader">SIZE</h4></th>
                                    <td><p>9</p></td>
                                </tr> 
                                <tr>
                                    <th><h4 class="tblHeader">QUANTITY</h4></th>
                                    <td><p>2</p></td>
                                </tr> 
                                <tr>
                                    <th><h4 class="tblHeader">COLOR</h4></th>
                                    <td><p>Black</p></td>
                                </tr>
                                <tr id="completedrating">
                                    <th><h4 class="tblHeader">RATE PRODUCT</h4></th>
                                    <td>
                                        <fieldset class="rating">
                                            <input type="radio" id="star5" name="rating" value="5" /><label class = "full" for="star5" title="Awesome - 5 stars"></label>
                                            <input type="radio" id="star4" name="rating" value="4" /><label class = "full" for="star4" title="Pretty good - 4 stars"></label>
                                            <input type="radio" id="star3" name="rating" value="3" /><label class = "full" for="star3" title="Meh - 3 stars"></label>
                                            <input type="radio" id="star2" name="rating" value="2" /><label class = "full" for="star2" title="Kinda bad - 2 stars"></label>
                                            <input type="radio" id="star1" name="rating" value="1" /><label class = "full" for="star1" title="Sucks big time - 1 star"></label>
                                        </fieldset>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                <div class="editorder" id="edit_order">
                    <a href="OrderCustom.html" id="btnOrder">EDIT ORDER</a>
                </div>
            </div>
        </div>
    </body>
</html>
