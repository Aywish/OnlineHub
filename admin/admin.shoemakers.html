<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title class="customer-name">Made in Marikina - Products</title>
    
        <!-- bootstrap and css -->
        <link type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
        <link rel="stylesheet" href="../css/AdminAccess.css">

        <!--javascript -->
    <script type="text/javascript">
        //popup
        function OpenPopup() {
            document.getElementById("popup_product").style.display = "block";
            document.getElementById("bgoverlay").style.display = "block";
        }

        function OpenPopupView() {
            document.getElementById("popup_viewSM").style.display = "block";
            document.getElementById("bgoverlay").style.display = "block";
        }

        function ClosePopup() {
            document.getElementById("popup_product").style.display = "none";
            document.getElementById("popup_viewSM").style.display = "none";
            document.getElementById("bgoverlay").style.display = "none";
        }
    </script>
    
        <!-- icons -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css">
    
    </head>
    <body>

        <div class="top-level">
            <div class="top-title">
                <h1>Manage Shoemakers.</h1>
            </div>
            <div class="top-buttons">
                <label for="add" class="buttonss products-add" onclick="OpenPopup()">
                    <i class="bi bi-plus-circle"></i>
                    <span>ADD</span>
                </label>
                <br>
            </div>
        </div>

        
        <!--POPUP-->
        <div class="popup" id="popup_product">
            <div class="popup-scrollable">
                <i class="bi bi-x" onclick="ClosePopup()"></i>
                <div class="popup-content">
                    <div class="profile-picture">
                        <img src="images/logo.png" alt="">
                    </div>
                    
                    <form action="" class="popup-form">
                        <h5>Store Name</h5>
                            <input type="text" placeholder="Full Store Name" class="storeName" id="storename">
                        <h5>Full Name</h5>
                            <input type="text" placeholder="First Name" class="fullName" id="firstname">
                            <input type="text" placeholder="Middle Name" class="fullName" id="middlename">
                            <input type="text" placeholder="Last Name" class="fullName" id="lastname">
                            <input type="text" placeholder="Suffix" class="fullName" id="suffix">
                        <h5>Complete Address</h5>
                            <input type="text" placeholder="House No." class="address" id="houseno" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');">
                            <input type="text" placeholder="Street Name" class="address" id="streetname">
                            <input type="text" placeholder="Baranggay" class="address" id="baranggay">
                            <input type="text" placeholder="City" class="address" id="city">
                            <input type="text" placeholder="Postal Code." class="address" id="postalcode" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');">
                        <h5>Contact Information</h5>
                            <input type="text" placeholder="Mobile Number" class="contact" id="mobilenumber" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');">
                            <input type="text" placeholder="Email Address" class="contact" id="email">
                    </form>
                </div>
            </div>
            <div class="addshoemaker">
                <a href="#" id="addshoemaker">ADD SHOEMAKER</a>
            </div>
        </div>

        <!--END OF POPUP-->

        <!--VIEW SHOEMAKER POPUP-->
        <div class="popup" id="popup_viewSM">
            <div class="popup-scrollable">
                <i class="bi bi-x" onclick="ClosePopup()"></i>
                <div class="popup-content">
                    <div class="profile-picture">
                        <img src="images/logo.png" alt="">
                    </div>
                    
                    <form action="" class="popup-form">
                        <h5>Store Name</h5>
                            <p id="shoemaker_storename" class="shoemakers_view">Tatay Oly Shoes</p>
                        <h5>Full Name</h5>
                            <table class="shoemakers_view shoemakers_fullname">
                                <tr>
                                    <th>First Name:</th>
                                    <td>Rolando</td>
                                </tr>
                                <tr>
                                    <th>Middle Name:</th>
                                    <td></td>
                                </tr>
                                <tr>
                                    <th>Last Name:</th>
                                    <td>Santos</td>
                                </tr>
                                <tr>
                                    <th>Suffix:</th>
                                    <td>Sr.</td>
                                </tr>
                            </table>
                        <h5>Complete Address</h5>
                            <table class="shoemakers_view shoemakers_fulladdress">
                                <tr>
                                    <th>House No:</th>
                                    <td>365</td>
                                </tr>
                                <tr>
                                    <th>Street Name:</th>
                                    <td>J.P. Rizal</td>
                                </tr>
                                <tr>
                                    <th>Baranggay:</th>
                                    <td>Sto. Ni√±o</td>
                                </tr>
                                <tr>
                                    <th>City:</th>
                                    <td>Marikina</td>
                                </tr>
                                <tr>
                                    <th>Postal Code:</th>
                                    <td>1800</td>
                                </tr>
                            </table>
                        <h5>Contact Information</h5>
                        <table class="shoemakers_view shoemakers_fulladdress">
                            <tr>
                                <th>Mobile Number:</th>
                                <td>+639876543210</td>
                            </tr>
                            <tr>
                                <th>Email Address:</th>
                                <td>tatayoly@gmail.com</td>
                            </tr>
                        </table>
                    </form>
                </div>
            </div>
            <div class="addshoemaker">
                <a href="#" id="addshoemaker">ADD SHOEMAKER</a>
            </div>
        </div>
        <!--END OF POPUP-->

        <div class="table">
            <table id="admin-shmkrview">
                <tr>
                    <th><h4 class="admin-tblHeader">IMAGE</h4></th>
                    <th><h4 class="admin-tblHeader">SHOP NAME</h4></th>
                    <th><h4 class="admin-tblHeader">SHOP OWNER</h4></th>
                    <th><h4 class="admin-tblHeader">ADDRESS</h4></th>
                    <th><h4 class="admin-tblHeader">ACTIONS</h4></th>
                </tr>
                
            </table>
        </div>

        <script>
            
            var userId = localStorage.getItem("userID");

            var storeName, firstName, middleName, lastName, suffix, houseNo, stName, brgy, city, postalCode, contactNo, email, viewshmkrId;

            
            var shmkrReference = firebase.database().ref().child("users/").orderByChild('accountType').equalTo("shoemaker");
            shmkrReference.on("child_added", snap => {
                var shmkrId = snap.child("uid").val();
                var shopName = snap.child("storeName").val();
                var fName = snap.child("firstName").val();
                var lName = snap.child("lastName").val();
                var hNo = snap.child("houseNo").val();
                var brgy = snap.child("barangay").val();
                var city = snap.child("city").val();
                var pCode = snap.child("postalCode").val();
                var stName = snap.child("streetName").val();
                

                $("#admin-shmkrview").append('<tr><td><img class="admin-image" src="images/user.jpg"></td><td><p>' + shopName + '</p></td><td><p>' + fName + ' ' + lName + '</p></td><td><p>' + hNo + ' ' + stName + ' '  + brgy + ', ' + city + ', ' + pCode + '</p></td><td><button class="button-actions"onclick="OpenPopupView()"><i class="bi bi-eye"></i><span>VIEW</span></button><button class="button-actions"><i class="fa fa-trash" aria-hidden="true"></i><span>DELETE</span></button></td></tr>');
            });


            function readAddForm() {
                storeName = document.getElementById("storename").value;
                firstName = document.getElementById("firstname").value;
                middleName = document.getElementById("middlename").value;
                lastName = document.getElementById("lastname").value;
                suffix = document.getElementById("suffix").value;
                houseNo = document.getElementById("houseno").value;
                stName = document.getElementById("streetname").value;
                brgy = document.getElementById("baranggay").value;
                city = document.getElementById("city").value;
                postalCode = document.getElementById("postalcode").value;
                contactNo = document.getElementById("mobilenumber").value;
                email = document.getElementById("email").value;
            };
    

            addshoemaker.onclick = function () {
                readAddForm();

                firebase.auth().createUserWithEmailAndPassword(email, "password" + storeName)
                    .then((userCredential) => {
                        // Signed up 
                        var user = userCredential.user;
                        console.log(user.uid);
                            firebase
                            .database()
                            .ref("users/" + user.uid)
                            .set({
                            uid: user.uid,
                            storeName: storeName,
                            firstName: firstName,
                            middleName: middleName,
                            lastName: lastName,
                            suffix: suffix,
                            houseNo: houseNo,
                            streetName: stName,
                            barangay: brgy,
                            city: city,
                            postalCode: postalCode,
                            contactNo: contactNo,
                            email: email,
                            accountType: "shoemaker"
                        });
                alert("Shoemaker Added!");
                });
            };



        </script>
        
    </body>
</html>